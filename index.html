<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ðŸ”´ THE GREATEST HEIST - Complete Network (1976-2025)</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: #0a0a0a;
            color: #fff;
            overflow: hidden;
        }
        h1 {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #ff4444;
            font-size: 32px;
            text-shadow: 0 0 20px #ff0000;
            letter-spacing: 3px;
            z-index: 100;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { text-shadow: 0 0 10px #ff0000; }
            50% { text-shadow: 0 0 15px #ff0000; }
        }
        .controls {
            position: absolute;
            top: 70px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            background: rgba(0,0,0,0.9);
            padding: 15px 25px;
            border-radius: 10px;
            border: 2px solid #333;
        }
        button {
            background: linear-gradient(135deg, #ff4444, #cc0000);
            color: white;
            border: none;
            padding: 10px 18px;
            margin: 3px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.3s;
        }
        button:hover {
            background: linear-gradient(135deg, #ff6666, #ff0000);
            transform: translateY(-2px);
        }
        button.active { background: linear-gradient(135deg, #00ff00, #009900); }
        #graph { width: 100%; height: 100vh; }
        .node-circle { cursor: grab; stroke-width: 3px; }
        .node-circle:active { cursor: grabbing; }
        .node-circle:hover { stroke: #fff !important; stroke-width: 5px; filter: brightness(1.4); }
        .node-label {
            font-size: 11px;
            font-weight: bold;
            fill: #fff;
            text-anchor: middle;
            pointer-events: none;
            text-shadow: 0 0 3px #000, 0 0 6px #000, 0 0 9px #000;
        }
        .link { stroke-opacity: 0.35; pointer-events: none; }
        .tooltip {
            position: absolute;
            background: rgba(0,0,0,0.95);
            border: 2px solid #ff4444;
            border-radius: 8px;
            padding: 15px;
            font-size: 12px;
            pointer-events: none;
            max-width: 450px;
            box-shadow: 0 0 30px rgba(255,68,68,0.6);
            z-index: 1000;
            display: none;
        }
        .tooltip h3 { color: #ff4444; margin: 0 0 8px 0; font-size: 15px; }
        .tooltip p { margin: 4px 0; color: #ccc; line-height: 1.4; }
        .stats {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0,0,0,0.9);
            padding: 12px 18px;
            border-radius: 8px;
            border: 2px solid #333;
            color: #aaa;
            font-size: 12px;
            z-index: 100;
        }
        .stats span { color: #ff4444; font-weight: bold; }
        .legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0,0,0,0.9);
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #333;
            color: #aaa;
            font-size: 11px;
            z-index: 100;
            max-width: 200px;
        }
        .legend h4 {
            color: #ff4444;
            margin: 0 0 10px 0;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
            cursor: pointer;
            padding: 3px 5px;
            border-radius: 4px;
            transition: background 0.2s;
        }
        .legend-item:hover {
            background: rgba(255,255,255,0.1);
        }
        .legend-item.dimmed {
            opacity: 0.3;
        }
        .legend-color {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            margin-right: 8px;
            border: 2px solid #fff;
        }
        .legend-label {
            font-size: 10px;
            color: #ccc;
        }
        .node-halo {
            filter: drop-shadow(0 0 8px currentColor) drop-shadow(0 0 12px currentColor);
        }
        .password-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.98);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        .password-box {
            background: linear-gradient(135deg, #1a1a1a, #0a0a0a);
            padding: 40px 50px;
            border-radius: 15px;
            border: 3px solid #ff4444;
            box-shadow: 0 0 40px rgba(255, 68, 68, 0.5);
            text-align: center;
            max-width: 400px;
        }
        .password-box h2 {
            color: #ff4444;
            margin-bottom: 10px;
            font-size: 24px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .password-box p {
            color: #999;
            margin-bottom: 25px;
            font-size: 13px;
        }
        .password-box input {
            width: 100%;
            padding: 15px;
            background: #1a1a1a;
            border: 2px solid #333;
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
            margin-bottom: 20px;
            outline: none;
        }
        .password-box input:focus {
            border-color: #ff4444;
        }
        .password-box button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #ff4444, #cc0000);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        .password-box button:hover {
            background: linear-gradient(135deg, #ff6666, #ff0000);
            transform: translateY(-2px);
        }
        .password-error {
            color: #ff4444;
            font-size: 12px;
            margin-top: 10px;
            display: none;
        }
        .content {
            display: none;
        }
        .content.unlocked {
            display: block;
        }
    </style>
</head>
<body>
    <div id="password-overlay" class="password-overlay">
        <div class="password-box">
            <h2>ðŸ”’ RESTRICTED ACCESS</h2>
            <p>This visualization contains sensitive investigative research.</p>
            <input type="password" id="password-input" placeholder="Enter password" onkeypress="if(event.key==='Enter') checkPassword()">
            <button onclick="checkPassword()">UNLOCK</button>
            <div class="password-error" id="password-error">Incorrect password. Access denied.</div>
        </div>
    </div>

    <div class="content" id="main-content">
    <h1>ðŸ”´ THE GREATEST HEIST ðŸ”´</h1>

    <div class="controls">
        <button onclick="filterNetwork('all')" class="active" id="btn-all">ALL</button>
        <button onclick="filterNetwork('financial')">FINANCIAL</button>
        <button onclick="filterNetwork('russia')">RUSSIA</button>
        <button onclick="filterNetwork('israel')">ISRAEL</button>
        <button onclick="filterNetwork('cohen')">COHEN NETWORK</button>
        <button onclick="filterNetwork('tech')">TECH</button>
        <button onclick="filterNetwork('oligarchs')">RUSSIAN MAFIA</button>
        <button onclick="filterNetwork('lutnick')">LUTNICK</button>
        <button onclick="resetSimulation()">RESET</button>
    </div>

    <div class="stats">
        <strong>Network:</strong> <span id="node-count">0</span> nodes â€¢ <span id="link-count">0</span> connections
    </div>

    <div class="legend">
        <h4>Legend (Click to Filter)</h4>
        <div class="legend-item" onclick="toggleLegendFilter('russian')" data-type="russian">
            <div class="legend-color" style="background: #ff0000;"></div>
            <span class="legend-label">Russian Network</span>
        </div>
        <div class="legend-item" onclick="toggleLegendFilter('israeli')" data-type="israeli">
            <div class="legend-color" style="background: #0088ff;"></div>
            <span class="legend-label">Israeli Network</span>
        </div>
        <div class="legend-item" onclick="toggleLegendFilter('intelligence')" data-type="intelligence">
            <div class="legend-color" style="background: #ff6600;"></div>
            <span class="legend-label">Intelligence Ops</span>
        </div>
        <div class="legend-item" onclick="toggleLegendFilter('financial')" data-type="financial">
            <div class="legend-color" style="background: #00ff00;"></div>
            <span class="legend-label">Financial</span>
        </div>
        <div class="legend-item" onclick="toggleLegendFilter('tech')" data-type="tech">
            <div class="legend-color" style="background: #ffdd00;"></div>
            <span class="legend-label">Tech</span>
        </div>
        <div class="legend-item" onclick="toggleLegendFilter('legal')" data-type="legal">
            <div class="legend-color" style="background: #ff00ff;"></div>
            <span class="legend-label">Legal</span>
        </div>
        <div class="legend-item" onclick="toggleLegendFilter('entity')" data-type="entity">
            <div class="legend-color" style="background: #888888;"></div>
            <span class="legend-label">Entities</span>
        </div>
        <div class="legend-item" onclick="toggleLegendFilter('victim')" data-type="victim">
            <div class="legend-color" style="background: #ff44aa;"></div>
            <span class="legend-label">Victims</span>
        </div>
        <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #333;">
            <div style="font-size: 10px; color: #888; margin-bottom: 5px;">Line Thickness:</div>
            <div style="font-size: 9px; color: #aaa;">Weight 10 = Smoking Gun</div>
            <div style="font-size: 9px; color: #aaa;">Weight 1 = Weak Evidence</div>
        </div>
    </div>

    <svg id="graph"></svg>
    <div class="tooltip" id="tooltip"></div>

    <script>
        const width = window.innerWidth;
        const height = window.innerHeight;

        const colors = {
            russian: "#ff0000",      // Red for Russian allegiance
            israeli: "#0088ff",      // Blue for Israeli allegiance
            both: "#ff0088",         // Pink/magenta for dual allegiance
            intelligence: "#ff6600", // Orange
            financial: "#00ff00",    // Green (swapped with tech)
            tech: "#ffdd00",         // Yellow (swapped with financial)
            legal: "#ff00ff",        // Purple
            entity: "#888888",       // Gray
            victim: "#ff44aa",       // Pink
            event: "#aa44ff"         // Purple
        };

        function getNodeFill(node) {
            // For nodes with allegiance, show their ROLE as fill
            // Allegiance will be shown as stroke/halo
            if (node.allegiance && node.type !== 'hub' && node.type !== 'political') {
                return colors[node.type] || "#888";
            }
            // For pure allegiance nodes (Putin, Epstein, Trump), show allegiance
            if (node.allegiance) return colors[node.allegiance];
            return colors[node.type] || "#888";
        }

        function getNodeStroke(node) {
            // Show allegiance as stroke/halo for dual-nature nodes
            if (node.allegiance && node.type !== 'hub' && node.type !== 'political') {
                return colors[node.allegiance];
            }
            // Show secondaryType as stroke for institutions (e.g., Deutsche Bank = entity with financial stroke)
            if (node.secondaryType) {
                return colors[node.secondaryType];
            }
            // Big nodes get white stroke
            if (node.size >= 28) return "#fff";
            // Otherwise match fill
            return getNodeFill(node);
        }

        const graphData = {
            nodes: [
                // MAJOR HUBS - All size 30
                {id: "putin", label: "VLADIMIR PUTIN", type: "political", size: 30, allegiance: "russian"},
                {id: "xi", label: "XI JINPING", type: "political", size: 30},
                {id: "epstein", label: "JEFFREY EPSTEIN", type: "hub", size: 30, allegiance: "both"},
                {id: "trump", label: "DONALD TRUMP", type: "political", size: 30, allegiance: "russian"},
                {id: "thiel", label: "PETER THIEL", type: "tech", size: 30},

                // MAJOR PLAYERS size 26-28
                {id: "r_maxwell", label: "ROBERT MAXWELL", type: "hub", size: 28, allegiance: "both"},
                {id: "g_maxwell", label: "GHISLAINE MAXWELL", type: "hub", size: 28, allegiance: "both"},
                {id: "mogilevich", label: "SEMION MOGILEVICH", type: "financial", size: 28, allegiance: "both"},
                {id: "dimon", label: "JAMIE DIMON", type: "financial", size: 28},
                {id: "netanyahu", label: "BIBI NETANYAHU", type: "political", size: 26, allegiance: "israeli"},
                {id: "ehud_barak", label: "EHUD BARAK", type: "political", size: 26, allegiance: "israeli"},

                // INTELLIGENCE 20-24
                {id: "kgb", label: "KGB/FSB", type: "entity", size: 24, allegiance: "russian"},
                {id: "mossad", label: "MOSSAD", type: "entity", size: 24, allegiance: "israeli"},
                {id: "mi6", label: "MI6", type: "entity", size: 22},
                {id: "cia", label: "CIA", type: "entity", size: 22},
                {id: "israeli_intel", label: "ISRAELI MIL INTEL", type: "entity", size: 22, allegiance: "israeli"},
                {id: "chebrikov", label: "VIKTOR CHEBRIKOV", type: "intelligence", size: 22, allegiance: "russian"},
                {id: "kryuchkov", label: "VLADIMIR KRYUCHKOV", type: "intelligence", size: 22, allegiance: "russian"},
                {id: "churkin", label: "VITALY CHURKIN", type: "intelligence", size: 20, allegiance: "russian"},
                {id: "belyakov", label: "SERGEY BELYAKOV", type: "intelligence", size: 20, allegiance: "russian"},
                {id: "ben_menashe", label: "ARI BEN-MENASHE", type: "intelligence", size: 20, allegiance: "israeli"},

                // CHINESE OFFICIALS
                {id: "li_yuanchao", label: "LI YUANCHAO", type: "political", size: 22},
                {id: "wang_qishan", label: "WANG QISHAN", type: "political", size: 22},

                // JPMORGAN NETWORK
                {id: "staley", label: "JES STALEY", type: "financial", size: 24},
                {id: "erdoes", label: "MARY ERDOES", type: "financial", size: 22},
                {id: "cutler", label: "STEPHEN CUTLER", type: "legal", size: 18},
                {id: "jpmorgan", label: "JP MORGAN", type: "entity", size: 24},

                // FINANCIAL NETWORK
                {id: "leon_black", label: "LEON BLACK", type: "financial", size: 24},
                {id: "wexner", label: "LES WEXNER", type: "financial", size: 24},
                {id: "greenberg", label: "ALAN GREENBERG", type: "financial", size: 22},
                {id: "cayne", label: "JIMMY CAYNE", type: "financial", size: 20},
                {id: "bear_stearns", label: "BEAR STEARNS", type: "entity", size: 22},
                {id: "deutsche", label: "DEUTSCHE BANK", type: "entity", size: 24, secondaryType: "financial"},
                {id: "liquid_funding", label: "LIQUID FUNDING", type: "entity", size: 20},
                {id: "carbyne", label: "CARBYNE", type: "entity", size: 18},
                {id: "southern_trust", label: "SOUTHERN TRUST", type: "entity", size: 20},
                {id: "bowers", label: "THOMAS BOWERS", type: "financial", size: 18},
                {id: "milken", label: "MICHAEL MILKEN", type: "financial", size: 20},
                {id: "drexel", label: "DREXEL BURNHAM", type: "entity", size: 20},
                {id: "apollo", label: "APOLLO GLOBAL", type: "entity", size: 20},
                {id: "rothschild", label: "ARIANE DE ROTHSCHILD", type: "financial", size: 18},
                {id: "dubin", label: "GLENN DUBIN", type: "financial", size: 18},

                // RUSSIAN NETWORK
                {id: "deripaska", label: "OLEG DERIPASKA", type: "financial", size: 26, allegiance: "russian"},
                {id: "vekselberg", label: "VIKTOR VEKSELBERG", type: "financial", size: 26, allegiance: "russian"},
                {id: "rybolovlev", label: "DMITRY RYBOLOVLEV", type: "financial", size: 22, allegiance: "russian"},
                {id: "bogatin", label: "DAVID BOGATIN", type: "financial", size: 18, allegiance: "russian"},
                {id: "ivankov", label: "VYACHESLAV IVANKOV", type: "financial", size: 18, allegiance: "russian"},
                {id: "sater", label: "FELIX SATER", type: "financial", size: 20, allegiance: "both"},
                {id: "sheferovsky", label: "MIKHAIL SHEFEROVSKY", type: "financial", size: 16, allegiance: "russian"},
                {id: "kislin", label: "SEMYON KISLIN", type: "financial", size: 16, allegiance: "russian"},
                {id: "dmitriev", label: "KIRILL DMITRIEV", type: "intelligence", size: 18, allegiance: "russian"},

                // TRUMP INNER CIRCLE
                {id: "roy_cohn", label: "ROY COHN", type: "political", size: 22, allegiance: "both"},
                {id: "barrack", label: "TOM BARRACK", type: "political", size: 22},
                {id: "manafort", label: "PAUL MANAFORT", type: "political", size: 22, allegiance: "russian"},
                {id: "kushner", label: "JARED KUSHNER", type: "political", size: 20, allegiance: "israeli"},
                {id: "ivana", label: "IVANA TRUMP", type: "political", size: 18},
                {id: "stone", label: "ROGER STONE", type: "political", size: 18},
                {id: "cohen", label: "MICHAEL COHEN", type: "political", size: 22, allegiance: "both"},
                {id: "giuliani", label: "RUDY GIULIANI", type: "political", size: 18},
                {id: "richard_kahn", label: "RICHARD KAHN", type: "intelligence", size: 18, allegiance: "both"},
                {id: "lutnick", label: "HOWARD LUTNICK", type: "political", size: 26, allegiance: "russian"},
                {id: "russian_mafia", label: "RUSSIAN MAFIA", type: "financial", size: 28, allegiance: "russian"},
                {id: "bgc_international", label: "BGC INTERNATIONAL", type: "entity", size: 22, allegiance: "russian"},
                {id: "sarah_ferguson", label: "SARAH FERGUSON", type: "political", size: 16},
                {id: "aubin_securities", label: "AUBIN SECURITIES", type: "entity", size: 16, allegiance: "russian"},
                {id: "parabridge", label: "PARABRIDGE INTL", type: "entity", size: 16, allegiance: "russian"},
                {id: "witkoff", label: "STEVE WITKOFF", type: "political", size: 20, allegiance: "russian"},
                {id: "dubinin", label: "YURI DUBININ", type: "intelligence", size: 16},
                {id: "vrablic", label: "ROSEMARY VRABLIC", type: "financial", size: 14},

                // ARMS DEALERS & IRAN-CONTRA
                {id: "khashoggi", label: "ADNAN KHASHOGGI", type: "financial", size: 22},
                {id: "leese", label: "DOUGLAS LEESE", type: "intelligence", size: 20},
                {id: "hoffenberg", label: "STEVEN HOFFENBERG", type: "financial", size: 20},
                {id: "towers", label: "TOWERS FINANCIAL", type: "entity", size: 18},
                {id: "iran_contra", label: "IRAN-CONTRA", type: "event", size: 20},
                {id: "tower_john", label: "JOHN TOWER", type: "political", size: 16},

                // PAYPAL MAFIA
                {id: "musk", label: "ELON MUSK", type: "tech", size: 28, allegiance: "russian"},
                {id: "starlink", label: "STARLINK", type: "entity", size: 22, allegiance: "russian"},
                {id: "spacex", label: "SPACEX", type: "entity", size: 20},
                {id: "doge", label: "DOGE", type: "entity", size: 20, allegiance: "russian"},
                {id: "hoffman", label: "REID HOFFMAN", type: "tech", size: 20},
                {id: "zuckerberg", label: "MARK ZUCKERBERG", type: "tech", size: 20},
                {id: "palantir", label: "PALANTIR", type: "entity", size: 20},
                {id: "cambridge", label: "CAMBRIDGE ANALYTICA", type: "entity", size: 18},
                {id: "mercer", label: "ROBERT MERCER", type: "political", size: 18},
                {id: "bannon", label: "STEVE BANNON", type: "political", size: 18},

                // LEGAL TEAM
                {id: "acosta", label: "ALEXANDER ACOSTA", type: "legal", size: 20},
                {id: "barr", label: "WILLIAM BARR", type: "legal", size: 20},
                {id: "starr", label: "KENNETH STARR", type: "legal", size: 18},
                {id: "lefkowitz", label: "JAY LEFKOWITZ", type: "legal", size: 18},
                {id: "dershowitz", label: "ALAN DERSHOWITZ", type: "legal", size: 18},
                {id: "kirkland", label: "KIRKLAND & ELLIS", type: "entity", size: 18},
                {id: "weingarten", label: "REID WEINGARTEN", type: "legal", size: 16},

                // EPSTEIN OPERATIONS
                {id: "groff", label: "LESLEY GROFF", type: "financial", size: 14},
                {id: "kellen", label: "SARAH KELLEN", type: "financial", size: 14},
                {id: "brunel", label: "JEAN-LUC BRUNEL", type: "financial", size: 16},

                // POLITICAL FIGURES
                {id: "shamir", label: "YITZHAK SHAMIR", type: "political", size: 18},
                {id: "bush", label: "GEORGE H.W. BUSH", type: "political", size: 20},
                {id: "clinton", label: "BILL CLINTON", type: "political", size: 20},
                {id: "gates", label: "BILL GATES", type: "tech", size: 20},
                {id: "nancy_reagan", label: "NANCY REAGAN", type: "political", size: 16},
                // lutnick defined above in TRUMP INNER CIRCLE
                {id: "witkoff", label: "STEVE WITKOFF", type: "political", size: 18},
                {id: "vance", label: "JD VANCE", type: "political", size: 22},
                {id: "bondi", label: "PAM BONDI", type: "legal", size: 18},
                {id: "mbs", label: "MOHAMMED BIN SALMAN", type: "political", size: 24},
                {id: "mbz", label: "MOHAMMED BIN ZAYED", type: "political", size: 22},
                {id: "michael_wolff", label: "MICHAEL WOLFF", type: "political", size: 16},
                {id: "ruemmler", label: "KATHY RUEMMLER", type: "political", size: 16},
                {id: "prince_andrew", label: "PRINCE ANDREW", type: "political", size: 18},
                {id: "mandelson", label: "PETER MANDELSON", type: "political", size: 16},

                // OTHER KEY
                {id: "lukanov", label: "ANDREI LUKANOV", type: "intelligence", size: 14},
                {id: "colony", label: "COLONY CAPITAL", type: "entity", size: 16},
                {id: "qatar", label: "QATAR", type: "political", size: 16},
                {id: "al_waleed", label: "PRINCE AL-WALEED", type: "financial", size: 16},
                {id: "promis", label: "PROMIS SOFTWARE", type: "entity", size: 18},
                {id: "wexner_mansion", label: "WEXNER MANSION", type: "entity", size: 18},

                // VICTIMS
                {id: "katie_johnson", label: "KATIE JOHNSON", type: "victim", size: 16},
                {id: "v_giuffre", label: "VIRGINIA GIUFFRE", type: "victim", size: 16},
                {id: "tiffany_doe", label: "TIFFANY DOE", type: "victim", size: 14},

                // EVENTS
                {id: "2008_crash", label: "2008 CRISIS", type: "event", size: 20},
                {id: "election_2024", label: "2024 ELECTION", type: "event", size: 16}
            ],

            links: [
// ALL 109 ORIGINAL CONNECTIONS + 100+ NEW ONES

// PUTIN CONNECTIONS
{source: "putin", target: "mogilevich", type: "intelligence", label: "Power behind Putin presidency", weight: 9},
{source: "putin", target: "kgb", type: "intelligence", label: "KGB officer FSB director", weight: 10},
{source: "putin", target: "sater", type: "political", label: "Red Square from Putin's office", weight: 7},
{source: "putin", target: "rybolovlev", type: "financial", label: "Close Putin circle oligarch", weight: 9},
{source: "putin", target: "dmitriev", type: "financial", label: "RDIF Putin's investment envoy", weight: 9},

// XI JINPING CONNECTIONS (NEW!)
{source: "xi", target: "li_yuanchao", type: "political", label: "Vice President 2013-18", weight: 10},
{source: "xi", target: "wang_qishan", type: "political", label: "Vice President Politburo Standing Committee", weight: 10},

// CHINESE OFFICIALS (NEW!)
{source: "li_yuanchao", target: "staley", type: "intelligence", label: "2hr meeting Organization Dept Minister", weight: 10},
{source: "li_yuanchao", target: "epstein", type: "intelligence", label: "Staley reported to Epstein on meeting", weight: 10},
{source: "wang_qishan", target: "dimon", type: "financial", label: "Vice Premier met with JPM CEO", weight: 10},
{source: "wang_qishan", target: "staley", type: "financial", label: "Most senior JPM meeting", weight: 9},

// EPSTEIN-CHINA CONNECTIONS (NEW!)
{source: "epstein", target: "staley", type: "intelligence", label: "China strategy memo Oct 2009", weight: 10},
{source: "staley", target: "epstein", type: "intelligence", label: "Reported China meetings like handler-asset", weight: 10},
{source: "epstein", target: "jpmorgan", type: "intelligence", label: "Geopolitical intel on China worth billions", weight: 10},

// EHUD BARAK CONNECTIONS (NEW!)
{source: "ehud_barak", target: "epstein", type: "intelligence", label: "22911 emails former Israeli PM", weight: 10},
{source: "ehud_barak", target: "israeli_intel", type: "intelligence", label: "Former IDF Chief Defense Minister PM", weight: 10},
{source: "ehud_barak", target: "netanyahu", type: "political", label: "Political rival same intelligence circles", weight: 7},
{source: "ehud_barak", target: "g_maxwell", type: "intelligence", label: "Visitor logs social events", weight: 8},

// NETANYAHU CONNECTIONS (NEW!)
{source: "netanyahu", target: "mossad", type: "intelligence", label: "Israeli PM Mossad oversight", weight: 10},
{source: "netanyahu", target: "trump", type: "political", label: "Political alliance", weight: 9},
{source: "netanyahu", target: "kushner", type: "political", label: "Kushner family friendship", weight: 9},

// JAMIE DIMON CONNECTIONS (NEW!)
{source: "dimon", target: "jpmorgan", type: "financial", label: "CEO claims never knew Epstein", weight: 10},
{source: "dimon", target: "staley", type: "financial", label: "Investment Bank CEO reported to Dimon", weight: 10},
{source: "dimon", target: "erdoes", type: "financial", label: "Wealth Management CEO", weight: 10},
{source: "dimon", target: "epstein", type: "financial", label: "2008 Dimon review 2010 dinner planning", weight: 10},

// STALEY-JPMORGAN NETWORK (NEW!)
{source: "staley", target: "epstein", type: "intelligence", label: "Called boss cherished friend family 93 emails", weight: 10},
{source: "staley", target: "prince_andrew", type: "political", label: "Epstein arranged meetings with royalty", weight: 8},
{source: "erdoes", target: "epstein", type: "financial", label: "Project Molecule profit splits", weight: 10},
{source: "cutler", target: "epstein", type: "legal", label: "GC said should not be client - kept 2 years", weight: 9},
{source: "jpmorgan", target: "dubin", type: "financial", label: "Epstein brokered $1.3B Highbridge deal", weight: 9},
{source: "dubin", target: "epstein", type: "financial", label: "$1.4M wires 2014-18", weight: 8},
{source: "jpmorgan", target: "bear_stearns", type: "financial", label: "Acquired March 2008 Fed backing", weight: 10},
{source: "jpmorgan", target: "liquid_funding", type: "financial", label: "Security Trustee of Epstein vehicle", weight: 10},

// TRUMP-RUSSIA MONEY (NEW!)
{source: "trump", target: "rybolovlev", type: "financial", label: "$95M mansion $30M overpayment 2008", weight: 10},
{source: "rybolovlev", target: "deutsche", type: "financial", label: "Entirely financed by Deutsche", weight: 10},
{source: "trump", target: "deutsche", type: "financial", label: "Only bank lending $2B+", weight: 10},
{source: "deutsche", target: "epstein", type: "financial", label: "Aug 19 2013 same day as Trump", weight: 10},
{source: "bowers", target: "deutsche", type: "financial", label: "Managed Trump+Epstein accounts", weight: 10},
{source: "bowers", target: "trump", type: "financial", label: "$330M+ loans", weight: 9},
{source: "bowers", target: "epstein", type: "financial", label: "40+ accounts died Nov 2019", weight: 9},

// TRUMP-EPSTEIN ALLEGATIONS (NEW!)
{source: "trump", target: "katie_johnson", type: "victim", label: "Lawsuit rape age 13 Wexner Mansion", weight: 10},
{source: "trump", target: "tiffany_doe", type: "victim", label: "Witness 4 encounters forcible rape", weight: 9},
{source: "trump", target: "wexner_mansion", type: "entity", label: "9 E 71st St location", weight: 9},
{source: "epstein", target: "katie_johnson", type: "victim", label: "1994 Wexner Mansion", weight: 10},
{source: "epstein", target: "tiffany_doe", type: "victim", label: "9yr recruiter witness", weight: 9},
{source: "katie_johnson", target: "wexner_mansion", type: "victim", label: "Age 13 1994", weight: 10},

// KATIE JOHNSON NETWORK RESPONSE (NEW!)
{source: "cohen", target: "trump", type: "political", label: "500+ threats 2016", weight: 10},
{source: "cohen", target: "katie_johnson", type: "victim", label: "Investigated now lies", weight: 10},
{source: "cohen", target: "kushner", type: "financial", label: "Money laundering network", weight: 9},
{source: "cohen", target: "vekselberg", type: "financial", label: "AT&T Russian oligarch payments", weight: 10},
{source: "richard_kahn", target: "epstein", type: "intelligence", label: "Tracked Cohen for Epstein", weight: 10},
{source: "richard_kahn", target: "cohen", type: "intelligence", label: "2019 monitoring Cohen testimony", weight: 9},
{source: "epstein", target: "cohen", type: "intelligence", label: "Epstein files withholding info", weight: 10},
{source: "lutnick", target: "epstein", type: "business", label: "Bought 11 E 71st St from Epstein for $10 via trust | island visits", weight: 10},
{source: "lutnick", target: "wexner", type: "financial", label: "Epstein-Wexner property network neighbor", weight: 9},
{source: "lutnick", target: "trump", type: "political", label: "Commerce Secretary regular meetings", weight: 9},
{source: "lutnick", target: "cohen", type: "political", label: "20+ year relationship", weight: 8},
{source: "lutnick", target: "russian_mafia", type: "financial", label: "FBI 302: money laundered through Cantor Fitzgerald was Russian Mafia", weight: 10},
{source: "lutnick", target: "bgc_international", type: "financial", label: "BGC Partners / BGC International subsidiary network", weight: 10},
{source: "lutnick", target: "g_maxwell", type: "social", label: "Dolce Vita Parties charity | Ferguson-Maxwell connection", weight: 9},
{source: "lutnick", target: "sarah_ferguson", type: "social", label: "Office space above Cantor Fitzgerald for CIC charity", weight: 8},
{source: "lutnick", target: "parabridge", type: "financial", label: "Parabridge Intl: payroll + charity funds + illegal wire transfers", weight: 9},
{source: "bgc_international", target: "manafort", type: "financial", label: "Shared Inter Jura intermediaries FBI 302", weight: 10},
{source: "bgc_international", target: "russian_mafia", type: "financial", label: "Money laundering FBI 302 Feb 2021", weight: 10},
{source: "bgc_international", target: "deutsche", type: "financial", label: "Deutsche Bank Singapore + Hong Kong accounts via Parabridge", weight: 9},
{source: "aubin_securities", target: "russian_mafia", type: "financial", label: "Associated with banned Russian entities FBI 302", weight: 9},
{source: "lutnick", target: "aubin_securities", type: "financial", label: "Cantor Fitzgerald associate network", weight: 8},
{source: "sarah_ferguson", target: "g_maxwell", type: "social", label: "Dolce Vita Parties Children in Crisis charity", weight: 8},
{source: "witkoff", target: "trump", type: "political", label: "Middle East Envoy close friend", weight: 10},
{source: "witkoff", target: "kushner", type: "political", label: "Moscow negotiations Jan 2026", weight: 10},
{source: "witkoff", target: "putin", type: "political", label: "Backchannel to Kremlin", weight: 9},
{source: "epstein", target: "barrack", type: "political", label: "Apr 28 2016 alert 4:34 PM", weight: 10},
{source: "epstein", target: "michael_wolff", type: "political", label: "Wave this away offer", weight: 9},
{source: "epstein", target: "ruemmler", type: "political", label: "Apr 28 2016 Obama counsel", weight: 8},

// TRUMP BROADER NETWORK (NEW!)
{source: "trump", target: "roy_cohn", type: "political", label: "Mentor kompromat teacher", weight: 10},
{source: "trump", target: "stone", type: "political", label: "Political advisor 1980s+", weight: 9},
{source: "trump", target: "giuliani", type: "political", label: "Personal attorney", weight: 9},
{source: "trump", target: "acosta", type: "political", label: "Labor Secretary Epstein deal giver", weight: 10},
{source: "trump", target: "barr", type: "legal", label: "AG when Epstein died", weight: 9},

// ORIGINAL 109 CONNECTIONS (condensed)
{source: "kryuchkov", target: "r_maxwell", type: "intelligence", label: "KGB handler", weight: 10},
{source: "chebrikov", target: "r_maxwell", type: "intelligence", label: "1976 infect capitalism", weight: 10},
{source: "r_maxwell", target: "mogilevich", type: "business", label: "Toploenergo partnership", weight: 9},
{source: "r_maxwell", target: "g_maxwell", type: "family", label: "Father-daughter training", weight: 10},
{source: "r_maxwell", target: "epstein", type: "intelligence", label: "Introduced Israeli intel 1980s", weight: 10},
{source: "r_maxwell", target: "bush", type: "intelligence", label: "CIA backchannel to KGB", weight: 9},
{source: "r_maxwell", target: "shamir", type: "intelligence", label: "Mossad state funeral", weight: 10},
{source: "r_maxwell", target: "ben_menashe", type: "intelligence", label: "Israeli handler", weight: 10},
{source: "r_maxwell", target: "leese", type: "business", label: "Iran-Contra arms", weight: 9},
{source: "r_maxwell", target: "khashoggi", type: "business", label: "Iran-Contra deals", weight: 9},
{source: "r_maxwell", target: "lukanov", type: "intelligence", label: "KGB Bulgaria handler", weight: 9},
{source: "r_maxwell", target: "greenberg", type: "financial", label: "Bear Stearns mid-1970s", weight: 8},
{source: "r_maxwell", target: "kgb", type: "intelligence", label: "Triple agent", weight: 10},
{source: "r_maxwell", target: "mossad", type: "intelligence", label: "Handler relationship", weight: 10},
{source: "r_maxwell", target: "promis", type: "intelligence", label: "88 countries backdoor", weight: 10},
{source: "g_maxwell", target: "epstein", type: "intelligence", label: "Partners 1980s-2019", weight: 10},
{source: "g_maxwell", target: "trump", type: "social", label: "1989 yacht recruited", weight: 8},
{source: "g_maxwell", target: "wexner", type: "business", label: "Wexner Mansion 1991-2000", weight: 9},
{source: "g_maxwell", target: "israeli_intel", type: "intelligence", label: "Agent military intel", weight: 9},
{source: "epstein", target: "trump", type: "social", label: "Best friends 1987-2004", weight: 10},
{source: "epstein", target: "trump", type: "financial", label: "$450M matched resurrection", weight: 9},
{source: "epstein", target: "barrack", type: "business", label: "Sabotaged Towers deal", weight: 8},
{source: "epstein", target: "greenberg", type: "financial", label: "Hired 1976 never left", weight: 9},
{source: "epstein", target: "leese", type: "intelligence", label: "Arms training 1981-87", weight: 10},
{source: "epstein", target: "khashoggi", type: "business", label: "First client 1987", weight: 9},
{source: "epstein", target: "hoffenberg", type: "business", label: "Towers $450M architect", weight: 10},
{source: "epstein", target: "leon_black", type: "financial", label: "$158M 2012-17", weight: 10},
{source: "epstein", target: "wexner", type: "financial", label: "Power of attorney mansion", weight: 10},
{source: "epstein", target: "acosta", type: "political", label: "2008 sweetheart deal", weight: 10},
{source: "epstein", target: "lefkowitz", type: "legal", label: "Marriott breakfast Oct 2007", weight: 9},
{source: "epstein", target: "starr", type: "legal", label: "Lobbied DOJ kill prosecution", weight: 9},
{source: "epstein", target: "dershowitz", type: "legal", label: "$115k defense", weight: 9},
{source: "epstein", target: "groff", type: "business", label: "Assistant NPA immunity", weight: 8},
{source: "epstein", target: "kellen", type: "business", label: "NPA immunity", weight: 8},
{source: "epstein", target: "thiel", type: "intelligence", label: "May 2014 2015-16 ops", weight: 10},
{source: "epstein", target: "musk", type: "tech", label: "16 emails 2012-15", weight: 8},
{source: "epstein", target: "hoffman", type: "tech", label: "Aug 2 2015 dinner", weight: 8},
{source: "epstein", target: "zuckerberg", type: "tech", label: "Aug 2 2015 dinner", weight: 8},
{source: "epstein", target: "churkin", type: "intelligence", label: "2015-16 Trump psychology", weight: 10},
{source: "epstein", target: "belyakov", type: "intelligence", label: "Russia-SV bridge", weight: 10},
{source: "epstein", target: "israeli_intel", type: "intelligence", label: "Blackmail ops agent", weight: 9},
{source: "epstein", target: "clinton", type: "political", label: "Flight logs Foundation", weight: 9},
{source: "epstein", target: "gates", type: "tech", label: "Project Molecule Gates Foundation", weight: 8},
{source: "epstein", target: "prince_andrew", type: "political", label: "UK royalty access", weight: 9},
{source: "epstein", target: "mandelson", type: "political", label: "UK government official", weight: 8},
{source: "trump", target: "mogilevich", type: "financial", label: "Laundering network", weight: 9},
{source: "trump", target: "bogatin", type: "financial", label: "$6M 5 condos 1984", weight: 9},
{source: "trump", target: "ivankov", type: "financial", label: "Trump Tower Taj laundering", weight: 9},
{source: "trump", target: "sater", type: "business", label: "Bayrock Trump SoHo", weight: 9},
{source: "trump", target: "kislin", type: "business", label: "200 TVs KGB 1980", weight: 7},
{source: "trump", target: "ivana", type: "family", label: "Czech StB intel", weight: 8},
{source: "trump", target: "dubinin", type: "intelligence", label: "Soviet Ambassador 1986-87", weight: 8},
{source: "trump", target: "kgb", type: "intelligence", label: "1987 Moscow recruitment", weight: 9},
{source: "trump", target: "barrack", type: "business", label: "Plaza Hotel Black Monday", weight: 9},
{source: "trump", target: "khashoggi", type: "business", label: "Yacht zero down", weight: 8},
{source: "trump", target: "greenberg", type: "financial", label: "Casino bonds stockbroker", weight: 9},
{source: "trump", target: "leon_black", type: "financial", label: "1996 Moscow resurrection", weight: 8},
{source: "trump", target: "al_waleed", type: "financial", label: "Plaza bailout 1995", weight: 8},
{source: "trump", target: "kushner", type: "political", label: "Son-in-law senior adviser $2B Saudi", weight: 10},
{source: "trump", target: "v_giuffre", type: "victim", label: "Mar-a-Lago pipeline age 17", weight: 10},
{source: "mogilevich", target: "ivankov", type: "intelligence", label: "Personal US rep", weight: 10},
{source: "mogilevich", target: "sater", type: "business", label: "YBM Magnex", weight: 8},
{source: "mogilevich", target: "kgb", type: "intelligence", label: "Looted Soviet assets", weight: 9},
{source: "barrack", target: "colony", type: "business", label: "Founded 1991", weight: 8},
{source: "colony", target: "qatar", type: "financial", label: "Qatar backing", weight: 8},
{source: "leon_black", target: "milken", type: "business", label: "Drexel right-hand", weight: 9},
{source: "leon_black", target: "drexel", type: "financial", label: "Extracted $15-16M", weight: 9},
{source: "leon_black", target: "apollo", type: "business", label: "Founded Drexel money", weight: 9},
{source: "leon_black", target: "kushner", type: "financial", label: "$185M 2017", weight: 10},
{source: "milken", target: "drexel", type: "financial", label: "Junk bond empire", weight: 10},
{source: "greenberg", target: "bear_stearns", type: "business", label: "CEO hired Epstein financed Trump", weight: 10},
{source: "leese", target: "khashoggi", type: "business", label: "Al-Yamamah arms", weight: 9},
{source: "leese", target: "mi6", type: "intelligence", label: "MI6 knighted twice", weight: 9},
{source: "leese", target: "towers", type: "business", label: "Principal joint venture", weight: 9},
{source: "khashoggi", target: "iran_contra", type: "political", label: "Central arms dealer", weight: 10},
{source: "khashoggi", target: "towers", type: "financial", label: "Arms money laundering", weight: 9},
{source: "hoffenberg", target: "towers", type: "business", label: "Public face prison Epstein free", weight: 10},
{source: "tower_john", target: "iran_contra", type: "political", label: "Commission covered $600M", weight: 9},
{source: "wexner", target: "wexner_mansion", type: "business", label: "9 E 71st St owner", weight: 9},
{source: "starr", target: "kirkland", type: "business", label: "Kirkland lawyer", weight: 8},
{source: "lefkowitz", target: "kirkland", type: "business", label: "Kirkland background", weight: 8},
{source: "lefkowitz", target: "acosta", type: "political", label: "Marriott breakfast deal", weight: 9},
{source: "kirkland", target: "epstein", type: "legal", label: "$4M+ plea period", weight: 9},
{source: "bear_stearns", target: "liquid_funding", type: "financial", label: "40% owner Epstein vehicle", weight: 9},
{source: "bear_stearns", target: "2008_crash", type: "financial", label: "$29B bailout", weight: 10},
{source: "liquid_funding", target: "2008_crash", type: "financial", label: "$4B+ taxpayer bailout", weight: 10},
{source: "ben_menashe", target: "israeli_intel", type: "intelligence", label: "Israeli operative handler", weight: 10},
{source: "mossad", target: "iran_contra", type: "intelligence", label: "$600M slush Maxwell", weight: 10},
{source: "cia", target: "iran_contra", type: "political", label: "$600M CIA slush", weight: 10},
{source: "promis", target: "r_maxwell", type: "intelligence", label: "88 countries backdoor", weight: 10},
{source: "sater", target: "sheferovsky", type: "family", label: "Son of Mogilevich underboss", weight: 9},
{source: "roy_cohn", target: "nancy_reagan", type: "political", label: "Nancy confidante", weight: 8},
{source: "thiel", target: "musk", type: "business", label: "PayPal co-founders", weight: 7},
{source: "thiel", target: "hoffman", type: "business", label: "PayPal co-founders", weight: 7},
{source: "thiel", target: "palantir", type: "tech", label: "CEO Co-founder", weight: 10},
{source: "thiel", target: "zuckerberg", type: "tech", label: "First investor Facebook board", weight: 9},
{source: "thiel", target: "cambridge", type: "entity", label: "Inside enabler", weight: 9},
{source: "belyakov", target: "thiel", type: "intelligence", label: "July 6 2015 FSB-SV bridge", weight: 10},
{source: "belyakov", target: "leon_black", type: "intelligence", label: "Guzel Ganieva intel", weight: 9},
{source: "churkin", target: "thiel", type: "intelligence", label: "Oct 2016 coordination", weight: 10},
{source: "zuckerberg", target: "cambridge", type: "entity", label: "87M users breach", weight: 10},
{source: "mercer", target: "cambridge", type: "entity", label: "Funded", weight: 10},
{source: "bannon", target: "cambridge", type: "entity", label: "Orchestrated", weight: 10},
{source: "southern_trust", target: "thiel", type: "financial", label: "$40M Valar 2015-17", weight: 10},
{source: "epstein", target: "southern_trust", type: "financial", label: "$1.1B wires", weight: 10},
{source: "musk", target: "election_2024", type: "event", label: "$277M donation", weight: 10},
{source: "trump", target: "election_2024", type: "event", label: "Wins Nov 5 2024", weight: 10},
{source: "putin", target: "deripaska", type: "financial", label: "Close Putin oligarch aluminum empire", weight: 10},
{source: "putin", target: "vekselberg", type: "financial", label: "Close Putin oligarch energy empire", weight: 10},
{source: "deripaska", target: "manafort", type: "financial", label: "$19M debt Manafort owed", weight: 10},
{source: "manafort", target: "trump", type: "political", label: "Campaign chairman 2016 Ukraine Russia", weight: 10},
{source: "manafort", target: "stone", type: "political", label: "Business partners decades", weight: 9},
{source: "trump", target: "thiel", type: "political", label: "Funded Vance $15M VP pick", weight: 10},
{source: "thiel", target: "trump", type: "political", label: "2016 RNC speech major donor", weight: 10},
{source: "deripaska", target: "mogilevich", type: "financial", label: "Organized crime network overlap", weight: 8},
{source: "vekselberg", target: "deutsche", type: "financial", label: "Russian money laundering client", weight: 8},
{source: "belyakov", target: "deripaska", type: "intelligence", label: "Adviser to Deripaska", weight: 9},
{source: "v_giuffre", target: "g_maxwell", type: "victim", label: "Trafficking", weight: 10},

// MUSK-PUTIN-RUSSIA CONNECTIONS (NEW!)
{source: "musk", target: "putin", type: "intelligence", label: "Russian party within Trumpist movement", weight: 10},
{source: "musk", target: "trump", type: "political", label: "DOGE 2025 Russian IP breach to gov data", weight: 10},
{source: "musk", target: "starlink", type: "tech", label: "Founder CEO SpaceX", weight: 10},
{source: "musk", target: "spacex", type: "tech", label: "Founder CEO", weight: 10},
{source: "musk", target: "doge", type: "political", label: "Dept Govt Efficiency 2025", weight: 10},
{source: "starlink", target: "putin", type: "intelligence", label: "Russian breach US data direct to Russia via Starlink", weight: 10},
{source: "doge", target: "putin", type: "intelligence", label: "Russian IPs accessing US govt data whistleblower", weight: 10},

// MISSING CONNECTIONS ADDED
{source: "michael_wolff", target: "bannon", type: "political", label: "Fire and Fury Trump inner circle", weight: 8},
{source: "michael_wolff", target: "g_maxwell", type: "social", label: "Social connections Epstein circle", weight: 7},
{source: "staley", target: "ehud_barak", type: "intelligence", label: "Epstein arranged meetings Israeli PM", weight: 9},
{source: "staley", target: "dimon", type: "financial", label: "Investment Bank CEO reported to Dimon", weight: 10},
{source: "staley", target: "erdoes", type: "financial", label: "JPM executive team", weight: 9},
{source: "wexner", target: "staley", type: "financial", label: "Epstein broker Victoria's Secret", weight: 8},
{source: "wexner", target: "dimon", type: "financial", label: "JPM private client Epstein connection", weight: 8},
{source: "dubinin", target: "putin", type: "intelligence", label: "Soviet Ambassador recruited Trump 1987", weight: 9},
{source: "dubinin", target: "chebrikov", type: "intelligence", label: "KGB chain of command", weight: 9},
{source: "cohen", target: "sater", type: "financial", label: "Trump Tower Moscow Bayrock partner", weight: 10},
{source: "vance", target: "thiel", type: "political", label: "$15M backing Senate VP protege", weight: 10},
{source: "vance", target: "trump", type: "political", label: "VP 2024 Thiel pick", weight: 10},
{source: "kushner", target: "mbs", type: "financial", label: "$2B Saudi fund 6mo after leaving WH", weight: 10},
{source: "mbs", target: "trump", type: "political", label: "Saudi backing Kushner pipeline", weight: 9},
{source: "mbs", target: "mbz", type: "political", label: "UAE Saudi alliance", weight: 9},
{source: "lutnick", target: "trump", type: "political", label: "Commerce Secretary 2025 transition chair", weight: 10},
{source: "lutnick", target: "witkoff", type: "political", label: "Real estate Cantor Fitzgerald", weight: 8},
{source: "witkoff", target: "trump", type: "political", label: "Special envoy Middle East 2025", weight: 10},
{source: "bondi", target: "trump", type: "legal", label: "AG 2025 replaced Gaetz", weight: 10},
{source: "bondi", target: "acosta", type: "legal", label: "Florida AG Epstein case", weight: 9},
{source: "bannon", target: "trump", type: "political", label: "Chief strategist 2017 Cambridge Analytica", weight: 10},
{source: "bannon", target: "mercer", type: "political", label: "Funded Breitbart Cambridge", weight: 10},
{source: "bannon", target: "stone", type: "political", label: "Political operative network", weight: 8},

// ADDITIONAL MISSING CONNECTIONS
{source: "churkin", target: "dubinin", type: "intelligence", label: "Soviet/Russian diplomats UN ambassador", weight: 8},
{source: "mogilevich", target: "ehud_barak", type: "intelligence", label: "Israeli-Russian organized crime nexus", weight: 9},
{source: "sheferovsky", target: "mogilevich", type: "financial", label: "Son of Mogilevich underboss", weight: 9},
{source: "dmitriev", target: "leon_black", type: "financial", label: "RDIF Apollo connections", weight: 8},
{source: "dmitriev", target: "trump", type: "political", label: "RDIF Trump transition Seychelles", weight: 9},
{source: "epstein", target: "bear_stearns", type: "financial", label: "Greenberg hired 1976 proprietary trading", weight: 10},
{source: "epstein", target: "liquid_funding", type: "financial", label: "Bear Stearns Epstein structured vehicle", weight: 10},
{source: "wexner", target: "liquid_funding", type: "financial", label: "Investor Epstein vehicle", weight: 9},
{source: "cayne", target: "bear_stearns", type: "financial", label: "CEO succeeded Greenberg", weight: 10},
{source: "cayne", target: "greenberg", type: "financial", label: "Bridge partner CEO succession", weight: 9},
{source: "cayne", target: "epstein", type: "financial", label: "Bear Stearns CEO Epstein relationship", weight: 8},
{source: "carbyne", target: "ehud_barak", type: "intelligence", label: "Chairman Israeli surveillance tech", weight: 10},
{source: "carbyne", target: "epstein", type: "intelligence", label: "Investor board member", weight: 9},
{source: "carbyne", target: "wexner", type: "financial", label: "Investor Epstein connection", weight: 8}
]
        };

        document.getElementById('node-count').textContent = graphData.nodes.length;
        document.getElementById('link-count').textContent = graphData.links.length;

        const svg = d3.select("#graph")
            .attr("width", width)
            .attr("height", height);

        const g = svg.append("g");
        const zoom = d3.zoom()
            .scaleExtent([0.1, 4])
            .on("zoom", (event) => g.attr("transform", event.transform));
        svg.call(zoom);

        const tooltip = d3.select("#tooltip");
        let simulation;

        function initGraph() {
            g.selectAll("*").remove();

            simulation = d3.forceSimulation(graphData.nodes)
                .force("link", d3.forceLink(graphData.links)
                    .id(d => d.id)
                    .distance(d => {
                        const src = graphData.nodes.find(n => n.id === (d.source.id || d.source));
                        const tgt = graphData.nodes.find(n => n.id === (d.target.id || d.target));
                        const srcSize = src.size || 16;
                        const tgtSize = tgt.size || 16;
                        // Satellites closer to suns: if one is big (>= 26), pull closer
                        const maxSize = Math.max(srcSize, tgtSize);
                        const minSize = Math.min(srcSize, tgtSize);
                        if (maxSize >= 26) {
                            return (srcSize + tgtSize) * 6; // Closer to big nodes
                        }
                        return (srcSize + tgtSize) * 10; // Normal distance
                    })
                    .strength(0.08)) // Very weak = floppy strings
                .force("charge", d3.forceManyBody()
                    .strength(d => {
                        // Big nodes (suns) push each other harder
                        if (d.size >= 26) return -1 * d.size * 120;
                        return -1 * (d.size || 16) * 90;
                    }))
                .force("center", d3.forceCenter(width / 2, height / 2))
                .force("collision", d3.forceCollide()
                    .radius(d => (d.size || 16) * 4) // More separation
                    .strength(1.0));

            const link = g.append("g")
                .selectAll("line")
                .data(graphData.links)
                .enter().append("line")
                .attr("class", "link")
                .attr("stroke", d => {
                    if (d.type === 'intelligence') return "#ff6600";
                    if (d.type === 'financial') return "#ffaa00";
                    if (d.type === 'tech') return "#00ff00";
                    if (d.type === 'political') return "#0088ff";
                    if (d.type === 'blackmail') return "#ff0066";
                    if (d.type === 'victim') return "#ff44aa";
                    return "#666";
                })
                .attr("stroke-width", d => Math.sqrt(d.weight || 1) * 0.7);

            const node = g.append("g")
                .selectAll("g")
                .data(graphData.nodes)
                .enter().append("g")
                .call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended));

            node.append("circle")
                .attr("class", d => (d.size >= 26) ? "node-circle node-halo" : "node-circle")
                .attr("r", d => d.size || 16)
                .attr("fill", d => getNodeFill(d))
                .attr("stroke", d => getNodeStroke(d))
                .attr("stroke-width", d => {
                    // Thicker stroke for dual-nature nodes to show allegiance/role halo
                    if (d.allegiance && d.type !== 'hub' && d.type !== 'political') return 4;
                    if (d.secondaryType) return 4;
                    return 3;
                })
                .on("mouseover", function(event, d) {
                    tooltip.style("display", "block");
                    tooltip.html(`<h3>${d.label}</h3><p><strong>Type:</strong> ${d.type}</p>`)
                    .style("left", (event.pageX + 15) + "px")
                    .style("top", (event.pageY - 10) + "px");
                })
                .on("mouseout", function() {
                    tooltip.style("display", "none");
                });

            node.append("text")
                .attr("class", "node-label")
                .attr("dy", d => (d.size || 16) + 14)
                .text(d => d.label);

            simulation.on("tick", () => {
                link
                    .attr("x1", d => d.source.x)
                    .attr("y1", d => d.source.y)
                    .attr("x2", d => d.target.x)
                    .attr("y2", d => d.target.y);
                node.attr("transform", d => `translate(${d.x},${d.y})`);
            });
        }

        function dragstarted(event, d) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y;
        }

        function dragged(event, d) {
            d.fx = event.x;
            d.fy = event.y;
        }

        function dragended(event, d) {
            if (!event.active) simulation.alphaTarget(0);
            d.fx = null;
            d.fy = null;
        }

        let activeLegendFilters = new Set();

        function toggleLegendFilter(filterType) {
            // Clear top button filters when using legend
            document.querySelectorAll('.controls button').forEach(btn => btn.classList.remove('active'));
            document.getElementById('btn-all').classList.add('active');

            const legendItem = event.target.closest('.legend-item');

            // Toggle the filter
            if (activeLegendFilters.has(filterType)) {
                // Remove filter - un-highlight the legend item
                activeLegendFilters.delete(filterType);
                legendItem.classList.add('dimmed');
            } else {
                // Add filter - highlight the legend item
                activeLegendFilters.add(filterType);
                legendItem.classList.remove('dimmed');
            }

            // If no filters active, show all and reset all legend items
            if (activeLegendFilters.size === 0) {
                document.querySelectorAll('.legend-item').forEach(item => item.classList.remove('dimmed'));
                g.selectAll('.node-circle').style('opacity', 1);
                g.selectAll('.link').style('opacity', 0.35);
                return;
            }

            // Dim legend items that are NOT active
            document.querySelectorAll('.legend-item').forEach(item => {
                const itemType = item.getAttribute('data-type');
                if (!activeLegendFilters.has(itemType)) {
                    item.classList.add('dimmed');
                } else {
                    item.classList.remove('dimmed');
                }
            });

            // Show/dim nodes based on active filters
            g.selectAll('.node-circle').style('opacity', d => {
                // Show if ANY active filter matches
                for (let filter of activeLegendFilters) {
                    // Allegiance filters - ALWAYS show hubs and politicals with matching allegiance
                    if (filter === 'russian' && (d.allegiance === 'russian' || d.allegiance === 'both')) {
                        return 1; // Visible
                    }
                    if (filter === 'israeli' && (d.allegiance === 'israeli' || d.allegiance === 'both')) {
                        return 1; // Visible
                    }
                    // Type filters
                    if ((filter === 'intelligence' && d.type === 'intelligence') ||
                        (filter === 'financial' && d.type === 'financial') ||
                        (filter === 'tech' && d.type === 'tech') ||
                        (filter === 'legal' && d.type === 'legal') ||
                        (filter === 'entity' && d.type === 'entity') ||
                        (filter === 'victim' && d.type === 'victim')) {
                        return 1; // Visible
                    }
                }
                return 0.15; // Dimmed
            });

            // Highlight links where BOTH nodes are visible
            g.selectAll('.link').style('opacity', function(d) {
                const srcNode = graphData.nodes.find(n => n.id === d.source.id);
                const tgtNode = graphData.nodes.find(n => n.id === d.target.id);

                let srcVisible = false, tgtVisible = false;

                for (let filter of activeLegendFilters) {
                    if ((filter === 'russian' && (srcNode.allegiance === 'russian' || srcNode.allegiance === 'both')) ||
                        (filter === 'israeli' && (srcNode.allegiance === 'israeli' || srcNode.allegiance === 'both')) ||
                        (filter === 'intelligence' && srcNode.type === 'intelligence') ||
                        (filter === 'financial' && srcNode.type === 'financial') ||
                        (filter === 'tech' && srcNode.type === 'tech') ||
                        (filter === 'legal' && srcNode.type === 'legal') ||
                        (filter === 'entity' && srcNode.type === 'entity') ||
                        (filter === 'victim' && srcNode.type === 'victim')) {
                        srcVisible = true;
                    }
                    if ((filter === 'russian' && (tgtNode.allegiance === 'russian' || tgtNode.allegiance === 'both')) ||
                        (filter === 'israeli' && (tgtNode.allegiance === 'israeli' || tgtNode.allegiance === 'both')) ||
                        (filter === 'intelligence' && tgtNode.type === 'intelligence') ||
                        (filter === 'financial' && tgtNode.type === 'financial') ||
                        (filter === 'tech' && tgtNode.type === 'tech') ||
                        (filter === 'legal' && tgtNode.type === 'legal') ||
                        (filter === 'entity' && tgtNode.type === 'entity') ||
                        (filter === 'victim' && tgtNode.type === 'victim')) {
                        tgtVisible = true;
                    }
                }

                return (srcVisible && tgtVisible) ? 0.7 : 0.03; // Much brighter for visible connections
            });
        }

        function filterNetwork(network) {
            // Clear legend filters when using top buttons
            activeLegendFilters.clear();
            document.querySelectorAll('.legend-item').forEach(item => item.classList.remove('dimmed'));

            document.querySelectorAll('.controls button').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            let filteredNodes = graphData.nodes;
            let filteredLinks = graphData.links;

            if (network === 'financial') {
                const financialIds = ['dimon', 'staley', 'erdoes', 'jpmorgan', 'deutsche', 'bear_stearns',
                    'wexner', 'leon_black', 'greenberg', 'liquid_funding', 'southern_trust', 'apollo',
                    'drexel', 'milken', 'epstein', 'bowers'];
                filteredNodes = graphData.nodes.filter(n => financialIds.includes(n.id) || n.type === 'financial');
                const nodeIds = new Set(filteredNodes.map(n => n.id));
                filteredLinks = graphData.links.filter(l =>
                    nodeIds.has(l.source.id || l.source) && nodeIds.has(l.target.id || l.target));
            } else if (network === 'russia') {
                const russiaIds = ['putin', 'mogilevich', 'deripaska', 'vekselberg', 'rybolovlev',
                    'manafort', 'sater', 'bogatin', 'ivankov', 'kgb', 'churkin', 'belyakov', 'dmitriev',
                    'trump', 'stone', 'kushner', 'deutsche', 'russian_mafia', 'lutnick', 'bgc_international',
                    'aubin_securities', 'witkoff'];
                filteredNodes = graphData.nodes.filter(n => russiaIds.includes(n.id));
                const nodeIds = new Set(filteredNodes.map(n => n.id));
                filteredLinks = graphData.links.filter(l =>
                    nodeIds.has(l.source.id || l.source) && nodeIds.has(l.target.id || l.target));
            } else if (network === 'israel') {
                const israelIds = ['netanyahu', 'ehud_barak', 'mossad', 'israeli_intel', 'epstein',
                    'g_maxwell', 'r_maxwell', 'ben_menashe', 'shamir', 'kushner'];
                filteredNodes = graphData.nodes.filter(n => israelIds.includes(n.id));
                const nodeIds = new Set(filteredNodes.map(n => n.id));
                filteredLinks = graphData.links.filter(l =>
                    nodeIds.has(l.source.id || l.source) && nodeIds.has(l.target.id || l.target));
            } else if (network === 'tech') {
                const techIds = ['thiel', 'musk', 'zuckerberg', 'hoffman', 'gates', 'palantir',
                    'cambridge', 'starlink', 'spacex', 'epstein'];
                filteredNodes = graphData.nodes.filter(n => techIds.includes(n.id) || n.type === 'tech');
                const nodeIds = new Set(filteredNodes.map(n => n.id));
                filteredLinks = graphData.links.filter(l =>
                    nodeIds.has(l.source.id || l.source) && nodeIds.has(l.target.id || l.target));
            } else if (network === 'cohen') {
                const cohenIds = ['cohen', 'richard_kahn', 'lutnick', 'witkoff', 'trump', 'sater', 'epstein', 'kushner',
                    'vekselberg', 'wexner', 'katie_johnson', 'deutsche', 'roy_cohn', 'giuliani', 'stone',
                    'manafort', 'deripaska', 'rybolovlev', 'bogatin', 'mogilevich', 'putin',
                    'russian_mafia', 'bgc_international', 'aubin_securities', 'parabridge', 'sarah_ferguson', 'g_maxwell'];
                filteredNodes = graphData.nodes.filter(n => cohenIds.includes(n.id));
                const nodeIds = new Set(filteredNodes.map(n => n.id));
                filteredLinks = graphData.links.filter(l =>
                    nodeIds.has(l.source.id || l.source) && nodeIds.has(l.target.id || l.target));
            } else if (network === 'oligarchs') {
                const oligarchIds = ['putin', 'deripaska', 'vekselberg', 'rybolovlev', 'dmitriev',
                    'mogilevich', 'sater', 'bogatin', 'ivankov', 'manafort', 'trump', 'deutsche',
                    'russian_mafia', 'lutnick', 'bgc_international', 'aubin_securities', 'witkoff'];
                filteredNodes = graphData.nodes.filter(n => oligarchIds.includes(n.id));
                const nodeIds = new Set(filteredNodes.map(n => n.id));
                filteredLinks = graphData.links.filter(l =>
                    nodeIds.has(l.source.id || l.source) && nodeIds.has(l.target.id || l.target));
            } else if (network === 'lutnick') {
                const lutnickIds = ['lutnick', 'epstein', 'wexner', 'trump', 'cohen', 'g_maxwell',
                    'russian_mafia', 'bgc_international', 'manafort', 'deutsche', 'aubin_securities',
                    'parabridge', 'sarah_ferguson', 'witkoff', 'mogilevich', 'sater'];
                filteredNodes = graphData.nodes.filter(n => lutnickIds.includes(n.id));
                const nodeIds = new Set(filteredNodes.map(n => n.id));
                filteredLinks = graphData.links.filter(l =>
                    nodeIds.has(l.source.id || l.source) && nodeIds.has(l.target.id || l.target));
            }

            // Update display
            document.getElementById('node-count').textContent = filteredNodes.length;
            document.getElementById('link-count').textContent = filteredLinks.length;

            // Rebuild graph with filtered data
            g.selectAll("*").remove();
            buildGraph(filteredNodes, filteredLinks);
        }

        function buildGraph(nodes, links) {
            const sim = d3.forceSimulation(nodes)
                .force("link", d3.forceLink(links)
                    .id(d => d.id)
                    .distance(d => {
                        const src = nodes.find(n => n.id === (d.source.id || d.source));
                        const tgt = nodes.find(n => n.id === (d.target.id || d.target));
                        const srcSize = src.size || 16;
                        const tgtSize = tgt.size || 16;
                        const maxSize = Math.max(srcSize, tgtSize);
                        if (maxSize >= 26) return (srcSize + tgtSize) * 6;
                        return (srcSize + tgtSize) * 10;
                    })
                    .strength(0.08))
                .force("charge", d3.forceManyBody()
                    .strength(d => {
                        if (d.size >= 26) return -1 * d.size * 120;
                        return -1 * (d.size || 16) * 90;
                    }))
                .force("center", d3.forceCenter(width / 2, height / 2))
                .force("collision", d3.forceCollide()
                    .radius(d => (d.size || 16) * 4)
                    .strength(1.0));

            const link = g.append("g")
                .selectAll("line")
                .data(links)
                .enter().append("line")
                .attr("class", "link")
                .attr("stroke", d => {
                    if (d.type === 'intelligence') return "#ff6600";
                    if (d.type === 'financial') return "#ffaa00";
                    if (d.type === 'tech') return "#00ff00";
                    if (d.type === 'political') return "#0088ff";
                    if (d.type === 'blackmail') return "#ff0066";
                    if (d.type === 'victim') return "#ff44aa";
                    return "#666";
                })
                .attr("stroke-width", d => Math.sqrt(d.weight || 1) * 0.7);

            const node = g.append("g")
                .selectAll("g")
                .data(nodes)
                .enter().append("g")
                .call(d3.drag()
                    .on("start", (e, d) => {
                        if (!e.active) sim.alphaTarget(0.3).restart();
                        d.fx = d.x; d.fy = d.y;
                    })
                    .on("drag", (e, d) => { d.fx = e.x; d.fy = e.y; })
                    .on("end", (e, d) => {
                        if (!e.active) sim.alphaTarget(0);
                        d.fx = null; d.fy = null;
                    }));

            node.append("circle")
                .attr("class", d => (d.size >= 26) ? "node-circle node-halo" : "node-circle")
                .attr("r", d => d.size || 16)
                .attr("fill", d => getNodeFill(d))
                .attr("stroke", d => getNodeStroke(d))
                .attr("stroke-width", d => {
                    if (d.allegiance && d.type !== 'hub' && d.type !== 'political') return 4;
                    if (d.secondaryType) return 4;
                    return 3;
                })
                .on("mouseover", function(event, d) {
                    tooltip.style("display", "block");
                    tooltip.html(`<h3>${d.label}</h3><p><strong>Type:</strong> ${d.type}</p>`)
                        .style("left", (event.pageX + 15) + "px")
                        .style("top", (event.pageY - 10) + "px");
                })
                .on("mouseout", function() { tooltip.style("display", "none"); });

            node.append("text")
                .attr("class", "node-label")
                .attr("dy", d => (d.size || 16) + 14)
                .text(d => d.label);

            sim.on("tick", () => {
                link.attr("x1", d => d.source.x).attr("y1", d => d.source.y)
                    .attr("x2", d => d.target.x).attr("y2", d => d.target.y);
                node.attr("transform", d => `translate(${d.x},${d.y})`);
            });
        }

        function resetSimulation() {
            simulation.alpha(1).restart();
        }

        // Password protection
        async function checkPassword() {
            const input = document.getElementById('password-input').value;
            const errorDiv = document.getElementById('password-error');

            // Hash the input password
            const msgBuffer = new TextEncoder().encode(input);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');

            // Correct password hash (SHA-256 of the password)
            // Password: "epstein-supergraph-2026"
            const correctHash = "bae6c2af0a459044cb454881f42a628a59f9077cbbf38dc4ebb8582ee81434cd";

            if (hashHex === correctHash) {
                document.getElementById('password-overlay').style.display = 'none';
                document.getElementById('main-content').classList.add('unlocked');
                sessionStorage.setItem('auth', 'true');
                initGraph();
            } else {
                errorDiv.style.display = 'block';
                setTimeout(() => errorDiv.style.display = 'none', 3000);
            }
        }

        // Check if already authenticated in this session
        if (sessionStorage.getItem('auth') === 'true') {
            document.getElementById('password-overlay').style.display = 'none';
            document.getElementById('main-content').classList.add('unlocked');
            initGraph();
        }
    </script>
    </div>
</body>
</html>
